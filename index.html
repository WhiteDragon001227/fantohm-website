<!doctype html>
<html lang="en"><head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-HHRBGSB44D"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-HHRBGSB44D');
</script>

	<meta charset="utf-8">
	<link rel="icon" href="favicon.ico">
	<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no">
	<link rel="apple-touch-icon" href="logo192.png">
	<title>Fantohm</title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Caesar+Dressing&family=Montserrat:wght@300;400;900&display=swap" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="bootstrap.min.css">
	<link href="styles.css" type="text/css" rel="stylesheet">


<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script src="https://code.iconify.design/1/1.0.3/iconify.min.js"></script>


</head>
<body>
<section class="price" v-scope="Values({ initialCount: 1 })" @mounted="mounted" v-cloak>

      <div class="row text-on-brand text-center d-flex justify-content-center">
        <div class="col-md-2 values value-1">
          <div class="rounded py-2 bg-brand">
            <h3 class="mb-0">${{price}}</h3>
            <p class="lead mb-0">Price</p>
          </div>
        </div>
        <div class="col-md-2 values value-2">
          <div class="rounded py-2 bg-brand">
            <h3 class="mb-0">{{circulating_supply || '-'}}</h3>
            <p class="lead mb-0">Circulating supply</p>
          </div>
        </div>
        <div class="col-md-2 values value-3">
          <div class="rounded py-2 bg-brand">
            <h3 class="mb-0">${{market_cap}}</h3>
            <p class="lead mb-0">Market cap</p>
          </div>
        </div>
        <div class="col-md-2 values value-4">
          <div class="rounded py-2 bg-brand">
            <h3 class="mb-0">${{stakingTVL}}</h3>
            <p class="lead mb-0">Staking TVL</p>
          </div>
        </div>
        <div class="col-md-2 values value-5">
          <div class="rounded py-2 bg-brand">
            <h3 class="mb-0">{{APY}}%</h3>
            <p class="lead mb-0">APY</p>
          </div>
        </div>
      </div>

    </section>
<section class="header">
	<div class="container">

		<div class="row">
			<div class="col-12">
				<ul>
				<li><a href="https://discord.com/invite/6x2wHHVNpC" target="_blank"><span class="iconify" data-icon="akar-icons:discord-fill"></span></a></li>
				<li><a href="https://t.me/fantohm" target="_blank"><span class="iconify" data-icon="bx:bxl-telegram"></span></a></li>
				<li><a href="https://twitter.com/FantohmDAO" target="_blank"><span class="iconify" data-icon="akar-icons:twitter-fill"></span></a></li>
				<li><a href="https://github.com/fantohm-dev" target="_blank"><span class="iconify" data-icon="akar-icons:github-fill"></span></span></a></li>
				<li><a href="https://fantohm.gitbook.io/documentation/" target="_blank"><span class="iconify" data-icon="simple-icons:gitbook"></span></span></a></li>
				</ul>
			</div>
		</div>
	</div>
</section>
<section class="hero">
	<div class="container">

			<div class="logo">
				<img src="logo.png" />
			</div>
			<div>
			<h2>The Decentralized Reserve Currency</h2>
			<p>Fantohm is building a community-owned decentralized financial infrastructure to bring more stability and transparency for the world.</p>
			<p>
				<a href="https://app.fantohm.com/" class="button">Enter App</a> 	<a href="https://www.fantohm.com/fantohm-brandbook.pdf" class="button" target="_blank">Brandbook</a>
			</p>

		</div>
	</div>
</section>


<section class="how-it-works">
	<div class="container">
		<div class="row row-wrap align-items">
			<div class="col-12" style="text-align:center;">
				<h2 class="big">How Fantohm works</h2>
			</div>
			<div class="col-6 order-1 align-middle">
				<div class="content align-middle">
					<h3><span>1</span>Treasury Revenue</h3>
					<h2>Bonds & LP fees</h2>
					<p>Bond sales and LP Fees increase Fantohm's Treasury Revenue and lock in liquidity and help control FHM supply</p>
				</div>

			</div>
			<div class="col-6 order-2 content-img"><img src="ghost1.png" /></div>
			<div class="col-6 order-4">
				<div class="content">
					<h3><span>2</span>Treasury Growth</h3>
					<h2>Fantohm's Treasury</h2>
					<p>Treasury inflow is used to increase Fantohm's Treasury Balance and back outstanding FHM tokens and regulate staking APY</p>
				</div>
			</div>
			<div class="col-6 order-3 content-img"><img src="ghost2.png" /></div>
			<div class="col-6 order-5">
				<div class="content">
					<h3><span>3</span>Staking Rewards</h3>
					<h2>FHM Token</h2>
					<p>Compounds yields automatically through a treasury backed coin with intrinsic value</p>
				</div>
			</div>
			<div class="col-6 order-6 content-img"><img src="chost3.png" /></div>
		</div>
	</div>
</section>


<section class="community">
	<div class="container">

		<div class="row row-wrap join">
			<div class="col-12" style="text-align:center;">
				<h2 class="big">Join our community</h2>
			</div>
			<div class="col-12 social">
				<a href="https://discord.com/invite/6x2wHHVNpC" target="_blank"><span class="iconify" data-icon="akar-icons:discord-fill"></span></a>
				<a href="https://t.me/fantohm" target="_blank"><span class="iconify" data-icon="bx:bxl-telegram"></span></a>
				<a href="https://twitter.com/FantohmDAO" target="_blank"><span class="iconify" data-icon="akar-icons:twitter-fill"></span></a>
				<a href="https://github.com/fantohm-dev" target="_blank"><span class="iconify" data-icon="akar-icons:github-fill"></span></span></a>
				<a href="https://fantohm.gitbook.io/documentation/" target="_blank"><span class="iconify" data-icon="simple-icons:gitbook"></span></span></a>
			</div>
		</div>
	</div>
</section>
<script src="https://cdn.ethers.io/lib/ethers-5.2.umd.min.js"></script>
<script type="module">
import { createApp } from 'https://unpkg.com/petite-vue@0.3.0?module'
// for questions about the code: ask @oppasam

const Fantom = 250;
const Moonriver = 1285;
const networks = {
    [Fantom]: {
        SOHM_ADDRESS: "0x5E983ff70DE345de15DbDCf0529640F14446cDfa",
        STAKING_ADDRESS: "0xcb9297425C889A7CbBaa5d3DB97bAb4Ea54829c2",
        MARKET_PRICE_LP_ADDRESS: "0x46622913cE40c54Ec14857f72968d4BAAF963947",
        CIRCULATING_SUPPLY_ADDRESS: "0x59EC309001Ec92879790dbdd94d9180B8bCAe908",
        DAO_ADDRESS: "0xD4aC626A1F87b5955f78FF86237DB055e62D43a0",
        rpcUrl: 'https://rpc.ftm.tools',
        epochBlock: 20187783,
        blocktime: 0.867,
        epochInterval: 28800,
        liquidityPoolReserveDecimals: {
            token0Decimals: 18,
            token1Decimals: 9,
        },
    },
    [Moonriver]: {
        SOHM_ADDRESS: "0x1888BB30f9EdD63b265942F3E3D061F186f38079",
        STAKING_ADDRESS: "0xF5C7D63C5Fc0aD4b7Cef7d8904239860725Ebc87",
        MARKET_PRICE_LP_ADDRESS: "0x0b6116bb2926d996cdeba9e1a79e44324b0401c9",
        CIRCULATING_SUPPLY_ADDRESS: "0x9DC084Fd82860cDb4ED2b2BF59F1076F47B03Bd6",
        DAO_ADDRESS: "0xE3CD5475f18a97D3563307B4e1A6467470237927",
        rpcUrl: 'https://rpc.api.moonriver.moonbeam.network',
        blocktime: 12.8,
        epochBlock: 979500,
        epochInterval: 1960,
        liquidityPoolReserveDecimals: {
            token0Decimals: 6,
            token1Decimals: 9,
        },
    },
};

class Lazy {
    constructor(initializer) {
        this.instance = null;
        this.initializer = initializer;
    };
    value() {
        if (this.instance == null) {
            this.instance = this.initializer();
        }
        return this.instance;
    }
}

async function getMarketPrice(networkID, provider) {
    const marketPriceReserveAddress = networks[networkID].MARKET_PRICE_LP_ADDRESS;
    const pairContract = new ethers.Contract(marketPriceReserveAddress, contracts.PairContract, provider);
    const reserves = await pairContract.getReserves();
    const reserveDecimals = networks[networkID].liquidityPoolReserveDecimals;
    const marketPrice = (reserves[0] / Math.pow(10, reserveDecimals.token0Decimals)) / (reserves[1] / Math.pow(10, reserveDecimals.token1Decimals));
    return marketPrice;
}

function NetworkDetails(networkID, details, provider) {
    var _circSupplyContract = new ethers.Contract(
        details.CIRCULATING_SUPPLY_ADDRESS,
        contracts.CirculatingSupplyContract,
        provider
    );
    var _sfhmMainContract = new ethers.Contract(
        details.SOHM_ADDRESS,
        contracts.sOHMv2,
        provider
    );
    // var _fhmContract = new ethers.Contract(
    //     addresses.OHM_ADDRESS,
    //     sOHM,
    //     provider
    // );
    var _stakingContract = new ethers.Contract(
        details.STAKING_ADDRESS,
        contracts.OlympusStakingv2,
        provider
    );

    var getOriginalStakingCircSupply = async () => {
        // _originalStakingCircSupply
        return await _sfhmMainContract.circulatingSupply() / Math.pow(10, 9);
    };
    var getStakingCircSupply = async () => {
        const daoSfhmBalance = new Lazy(async () => await _sfhmMainContract.balanceOf(details.DAO_ADDRESS) / Math.pow(10, 9));
        // _staking_cs
        return (await this._originalStakingCircSupply) - (await daoSfhmBalance.value());
    };

    var getTVL = async () => {
        // _stakingTVL
        return (await this._staking_cs) * (await this.price.value());
    };

    var getAPY = async () => {
        const epoch = new Lazy(async () => await _stakingContract.epoch());
        const distribute = new Lazy(async () => (await epoch.value()).distribute / Math.pow(10, 9));
        //
        this.stakingRewardFHM = new Lazy(async () => (await distribute.value()) * (await this._staking_cs) / (await this._originalStakingCircSupply));
        this.stakingRebase = new Lazy(async () => await this.stakingRewardFHM.value() / await this._originalStakingCircSupply);
        this.secondsPerEpoch = new Lazy(async () => details.blocktime * details.epochInterval);
        // this._stakingAPY
        const rebasesPerDay = 24 * 60 * 60 / await this.secondsPerEpoch.value();
        const stakingRebase = await this.stakingRebase.value();
        return Math.pow(1 + stakingRebase, 365 * rebasesPerDay) - 1;
        //
        return new Lazy(async () => {
            const rebasesPerDay = 24 * 60 * 60 / await this.secondsPerEpoch;
            const stakingRebase = await this.stakingRebase;
            return Math.pow(1 + stakingRebase, 365 * rebasesPerDay) - 1;
        });
    };

    this.price = new Lazy(async () => await getMarketPrice(networkID, provider));
    this.cs = new Lazy(async () => await _circSupplyContract.OHMCirculatingSupply() / Math.pow(10, 9));
    this.mc = new Lazy(async () => (await this.price.value()) * (await this.cs.value()));
    this._originalStakingCircSupply = getOriginalStakingCircSupply();
    this._staking_cs = getStakingCircSupply();
    this.tvl = new Lazy(async () => await getTVL());
    this.apy = new Lazy(async () => await getAPY());
}

async function Global() {
    let networkDetailMap = {};
    Object.keys(networks).forEach((networkID) => {
        let details = networks[networkID];
        let provider = new ethers.providers.JsonRpcProvider(details.rpcUrl);
        networkDetailMap[networkID] = new NetworkDetails(networkID, details, provider);
    });

    let networkIDs = Object.keys(networks);
    const marketPrice = (await 
        networkDetailMap[networkIDs[0]].price.value()
    );
    const globalCircSupply = (await Promise.all(networkIDs.map(networkID =>
        networkDetailMap[networkID].cs.value()
    ))).reduce((sum, a) => sum + a, 0);
    const globalMarketCap = (await Promise.all(networkIDs.map(networkID =>
        networkDetailMap[networkID].mc.value()
    ))).reduce((sum, a) => sum + a, 0);
    const globalStakingTVL = (await Promise.all(networkIDs.map(networkID =>
        networkDetailMap[networkID].tvl.value()
    ))).reduce((sum, a) => sum + a, 0);
    const globalStakingAPY = (await Promise.all(networkIDs.map(networkID =>
        networkDetailMap[networkID].apy.value()
    ))).reduce((sum, a) => sum + a * (1 / networkIDs.length), 0);

    return {
        marketPrice: marketPrice,
        globalCircSupply: globalCircSupply,
        globalMarketCap: globalMarketCap,
        globalStakingTVL: globalStakingTVL,
        globalStakingAPY: globalStakingAPY,
    };
}

const contracts = {
    sOHMv2: null,
    PairContract: null,
    OlympusStakingv2: null,
    CirculatingSupplyContract: null,
};

async function loadContracts() {
    let loadContract = function(name) {
        return new Promise(async (resolve, reject) => {
            let url = './abi/' + name + '.json';
            let obj = await (await fetch(url)).json();
            contracts[name] = obj.abi;
            resolve();
        });
    };
    await Promise.all(Object.keys(contracts).map(loadContract));
}

function formatDigits(str, decimalPlaces = 2){
    const arr = (''+str).split('.');
    const fraction = arr[1] .substr(0, decimalPlaces);
    return arr[0] + (fraction ? '.' + fraction : '');
}

function formatBigNumber(number, decimalPlaces = 2) {
    return number.toLocaleString('en-US', {maximumFractionDigits: decimalPlaces}); // "1,234,567,890"
}

// components
function Values(props) {
    return {
        stakingTVL: null,
        price: null,
        circulating_supply: null,
        APY: null,
        market_cap: null,
        async mounted() {
            await loadContracts();
            let result = await Global();
            this.stakingTVL = formatBigNumber(result.globalStakingTVL, 0);
            this.price = formatBigNumber(result.marketPrice);
            this.circulating_supply = formatBigNumber(parseInt(result.globalCircSupply));
            this.market_cap = formatBigNumber(parseInt(result.globalMarketCap), 0);
            this.APY = formatBigNumber(result.globalStakingAPY * 100, 0);
        },
    }
}

createApp({
  Values
}).mount()
</script>

</body>
</html>
